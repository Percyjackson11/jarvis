<div>Here's a solution using PHP as a signaling server to automate the WebRTC connection process. I'll create three main components:</div><div><br></div><div>A PHP API</div><div>Modified host page</div><div>Modified viewer page</div><div>First, create a signaling.php:</div><div><br></div><div><br></div><div>&lt;?php</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>$db = new SQLite3('webrtc.db');</div><div><br></div><div>// Create table if it doesn't exist</div><div>$db-&gt;exec('CREATE TABLE IF NOT EXISTS streams (</div><div>&nbsp; &nbsp; code TEXT PRIMARY KEY,</div><div>&nbsp; &nbsp; offer TEXT,</div><div>&nbsp; &nbsp; answer TEXT,</div><div>&nbsp; &nbsp; timestamp INTEGER</div><div>)');</div><div><br></div><div>if ($_SERVER['REQUEST_METHOD'] === 'POST') {</div><div>&nbsp; &nbsp; $data = json_decode(file_get_contents('php://input'), true);</div><div>&nbsp; &nbsp; $action = $data['action'];</div><div><br></div><div>&nbsp; &nbsp; if ($action === 'create') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Generate a unique 6-digit code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; do {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code = str_pad(rand(0, 999999), 6, '0', STR_PAD_LEFT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $exists = $db-&gt;querySingle("SELECT 1 FROM streams WHERE code = '$code'");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } while ($exists);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; $offer = $data['offer'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $timestamp = time();</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt = $db-&gt;prepare('INSERT INTO streams (code, offer, timestamp) VALUES (:code, :offer, :timestamp)');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;bindValue(':code', $code, SQLITE3_TEXT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;bindValue(':offer', $offer, SQLITE3_TEXT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;bindValue(':timestamp', $timestamp, SQLITE3_INTEGER);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;execute();</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['code' =&gt; $code]);</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; else if ($action === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $code = $data['code'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $answer = $data['answer'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt = $db-&gt;prepare('UPDATE streams SET answer = :answer WHERE code = :code');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;bindValue(':code', $code, SQLITE3_TEXT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;bindValue(':answer', $answer, SQLITE3_TEXT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $stmt-&gt;execute();</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['status' =&gt; 'success']);</div><div>&nbsp; &nbsp; }</div><div>}</div><div>else if ($_SERVER['REQUEST_METHOD'] === 'GET') {</div><div>&nbsp; &nbsp; $code = $_GET['code'];</div><div>&nbsp; &nbsp; $type = $_GET['type'];</div><div><br></div><div>&nbsp; &nbsp; if ($type === 'offer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $result = $db-&gt;querySingle("SELECT offer FROM streams WHERE code = '$code'", false);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['offer' =&gt; $result]);</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; else if ($type === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $result = $db-&gt;querySingle("SELECT answer FROM streams WHERE code = '$code'", false);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['answer' =&gt; $result]);</div><div>&nbsp; &nbsp; }</div><div>}</div><div><br></div><div>$db-&gt;close();</div><div>?&gt;</div><div>Modified host.html:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream&lt;/title&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Host Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;video id="localVideo" autoplay muted&gt;&lt;/video&gt;</div><div>&nbsp; &nbsp; &lt;div id="streamCode"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="startStream()"&gt;Start Stream&lt;/button&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let streamCode;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function startStream() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('localVideo').srcObject = localStream;</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; peerConnection.addTrack(track, localStream));</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = await peerConnection.createOffer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(</div><div><br></div><div><br></div><div>continue</div><div><br></div><div><br></div><div><br></div><div>Here's the complete modified host.html:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #streamCode {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 24px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 20px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f0f0f0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Host Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;video id="localVideo" autoplay muted&gt;&lt;/video&gt;</div><div>&nbsp; &nbsp; &lt;div id="streamCode"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="startStream()"&gt;Start Stream&lt;/button&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let streamCode;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = 'http://your-domain.com/signaling.php'; // Replace with your actual API URL</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function startStream() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('localVideo').srcObject = localStream;</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; peerConnection.addTrack(track, localStream));</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = await peerConnection.createOffer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(offer);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Wait for ICE gathering to complete</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await new Promise(resolve =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.addEventListener('icegatheringstatechange', () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Send offer to server and get stream code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(API_URL, {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method: 'POST',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers: {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Content-Type': 'application/json',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body: JSON.stringify({</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action: 'create',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; offer: JSON.stringify(peerConnection.localDescription)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; streamCode = data.code;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('streamCode').textContent = `Stream Code: ${streamCode}`;</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Poll for answer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pollForAnswer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function pollForAnswer() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const checkAnswer = async () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(`${API_URL}?code=${streamCode}&amp;type=answer`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (data.answer) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const answer = JSON.parse(data.answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setRemoteDescription(answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const poll = async () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!await checkAnswer()) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setTimeout(poll, 1000);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; poll();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/script&gt;</div><div>&lt;/body&gt;</div><div>&lt;/html&gt;</div><div>And here's the modified viewer.html:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Viewer Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #codeInput {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 18px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 5px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Viewer Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;input type="text" id="codeInput" placeholder="Enter stream code"&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="connectToHost()"&gt;Connect to Stream&lt;/button&gt;</div><div>&nbsp; &nbsp; &lt;video id="remoteVideo" autoplay&gt;&lt;/video&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script</div><div><br></div><div><br></div><div>continue</div><div><br></div><div><br></div><div><br></div><div>Here's the complete viewer.html:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Viewer Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #codeInput {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 18px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 5px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #remoteVideo {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max-width: 100%;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-top: 20px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; .error {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: red;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Viewer Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;input type="text" id="codeInput" placeholder="Enter stream code"&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="connectToHost()"&gt;Connect to Stream&lt;/button&gt;</div><div>&nbsp; &nbsp; &lt;div id="errorMessage" class="error"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;video id="remoteVideo" autoplay&gt;&lt;/video&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = 'http://your-domain.com/signaling.php'; // Replace with your actual API URL</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function connectToHost() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const streamCode = document.getElementById('codeInput').value.trim();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!streamCode) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError('Please enter a stream code');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Get the offer from the server</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(`${API_URL}?code=${streamCode}&amp;type=offer`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!data.offer) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError('Invalid stream code or stream not found');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Initialize WebRTC connection</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Handle incoming streams</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.ontrack = event =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('remoteVideo').srcObject = event.streams[0];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Set the offer and create answer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = JSON.parse(data.offer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setRemoteDescription(offer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const answer = await peerConnection.createAnswer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(answer);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Wait for ICE gathering to complete</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await new Promise(resolve =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.addEventListener('icegatheringstatechange', () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Send answer to server</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await fetch(API_URL, {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method: 'POST',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers: {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Content-Type': 'application/json',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body: JSON.stringify({</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action: 'answer',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; code: streamCode,</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; answer: JSON.stringify(peerConnection.localDescription)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Clear any error messages</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError('');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('Error:', error);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError('Failed to connect to stream');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; function showError(message) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = message;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Handle connection state changes</div><div>&nbsp; &nbsp; &nbsp; &nbsp; peerConnection?.addEventListener('connectionstatechange', () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.connectionState === 'failed') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError('Connection failed. Please try again.');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &lt;/script&gt;</div><div>&lt;/body&gt;</div><div>&lt;/html&gt;</div><div>To use this system:</div><div><br></div><div>Save the signaling.php file on your web server and make sure PHP has write permissions for the SQLite database.</div><div>Update the API_URL constant in both HTML files to point to your actual signaling.php URL.</div><div>Make sure your web server</div><div><br></div><div><br></div><div>can you make the signaling php without database? like perhaps use txt file to store data instead?</div><div><br></div><div><br></div><div><br></div><div>Here's a simplified version of signaling.php using text files instead of a database:</div><div><br></div><div><br></div><div>&lt;?php</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>// Directory to store stream data</div><div>$streamDir = 'streams/';</div><div>if (!file_exists($streamDir)) {</div><div>&nbsp; &nbsp; mkdir($streamDir, 0777, true);</div><div>}</div><div><br></div><div>// Clean up old streams (older than 1 hour)</div><div>cleanup($streamDir);</div><div><br></div><div>if ($_SERVER['REQUEST_METHOD'] === 'POST') {</div><div>&nbsp; &nbsp; $data = json_decode(file_get_contents('php://input'), true);</div><div>&nbsp; &nbsp; $action = $data['action'];</div><div><br></div><div>&nbsp; &nbsp; if ($action === 'create') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Generate a unique 6-digit code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; do {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code = str_pad(rand(0, 999999), 6, '0', STR_PAD_LEFT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } while (file_exists($streamDir . $code . '.json'));</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Save offer data</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $streamData = [</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'offer' =&gt; $data['offer'],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'timestamp' =&gt; time(),</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'answer' =&gt; null</div><div>&nbsp; &nbsp; &nbsp; &nbsp; ];</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; file_put_contents($streamDir . $code . '.json', json_encode($streamData));</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['code' =&gt; $code]);</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; else if ($action === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $code = $data['code'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $filePath = $streamDir . $code . '.json';</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists($filePath)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $streamData = json_decode(file_get_contents($filePath), true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $streamData['answer'] = $data['answer'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; file_put_contents($filePath, json_encode($streamData));</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['status' =&gt; 'success']);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http_response_code(404);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['error' =&gt; 'Stream not found']);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>}</div><div>else if ($_SERVER['REQUEST_METHOD'] === 'GET') {</div><div>&nbsp; &nbsp; $code = $_GET['code'];</div><div>&nbsp; &nbsp; $type = $_GET['type'];</div><div>&nbsp; &nbsp; $filePath = $streamDir . $code . '.json';</div><div><br></div><div>&nbsp; &nbsp; if (file_exists($filePath)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $streamData = json_decode(file_get_contents($filePath), true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if ($type === 'offer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['offer' =&gt; $streamData['offer']]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; else if ($type === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['answer' =&gt; $streamData['answer']]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; http_response_code(404);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['error' =&gt; 'Stream not found']);</div><div>&nbsp; &nbsp; }</div><div>}</div><div><br></div><div>// Function to clean up old stream files</div><div>function cleanup($dir) {</div><div>&nbsp; &nbsp; $files = glob($dir . '*.json');</div><div>&nbsp; &nbsp; $now = time();</div><div>&nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; foreach ($files as $file) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $streamData = json_decode(file_get_contents($file), true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Delete files older than 1 hour</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if ($now - $streamData['timestamp'] &gt; 3600) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unlink($file);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>}</div><div>?&gt;</div><div>This version:</div><div><br></div><div>Uses a directory called 'streams' to store JSON files for each stream</div><div>Each stream is stored in a separate file named with its code (e.g., "123456.json")</div><div>Automatically cleans up streams older than 1 hour</div><div>Doesn't require any database setup</div><div>To use this:</div><div><br></div><div>Create a directory called 'streams' in the same directory as your signaling.php</div><div>Make sure the 'streams' directory is writable by PHP:</div><div><br></div><div>chmod 777 streams</div><div>The host.html and viewer.html files remain exactly the same as in the previous example. Just make sure to update the API_URL in both files to point to your signaling.php location.</div><div><br></div><div>This solution is simpler to set up and doesn't require a database, but it might not be as efficient for handling large numbers of concurrent streams. It's good for small to medium-scale applications.</div><div><br></div><div><br></div><div><br></div><div>i think it's not working, when I start stream, it starts video but doesnt provide any unique code. i think it is not calling my signaling php only, as it didn't even create streams directory. (it has access)</div><div><br></div><div><br></div><div><br></div><div>Let's debug this issue. First, let's add some console logging to the host.html to see what's happening:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #streamCode {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 24px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 20px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f0f0f0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #errorMessage {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: red;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Host Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;video id="localVideo" autoplay muted&gt;&lt;/video&gt;</div><div>&nbsp; &nbsp; &lt;div id="streamCode"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;div id="errorMessage"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="startStream()"&gt;Start Stream&lt;/button&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let streamCode;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = '/signaling.php'; // Make sure this points to the correct path</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function startStream() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Starting stream...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('localVideo').srcObject = localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Got media stream');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; peerConnection.addTrack(track, localStream));</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Added tracks to peer connection');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = await peerConnection.createOffer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(offer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Created offer:', offer);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Wait for ICE gathering to complete</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await new Promise(resolve =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.addEventListener('icegatheringstatechange', () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('ICE gathering state:', peerConnection.iceGatheringState);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('ICE gathering completed');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Send offer to server and get stream code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Sending offer to server...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(API_URL, {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method: 'POST',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers: {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Content-Type': 'application/json',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body: JSON.stringify({</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action: 'create',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; offer: JSON.stringify(peerConnection.localDescription)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!response.ok) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error(`HTTP error! status: ${response.status}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Server response:', data);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; streamCode = data.code;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('streamCode').textContent = `Stream Code: ${streamCode}`;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = '';</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Poll for answer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pollForAnswer();</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('Error in startStream:', error);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = `Error: ${error.message}`;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function pollForAnswer() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const checkAnswer = async () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(`${API_URL}?code=${streamCode}&amp;type=answer`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (data.answer) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Got answer:', data.answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const answer = JSON.parse(data.answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setRemoteDescription(answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;</div><div><br></div><div><br></div><div>continue</div><div><br></div><div><br></div><div><br></div><div>Here's the complete updated host.html with error handling and debugging:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #streamCode {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 24px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 20px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f0f0f0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #errorMessage {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: red;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #debugInfo {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-family: monospace;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; white-space: pre-wrap;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f8f8f8;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-top: 20px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Host Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;video id="localVideo" autoplay muted&gt;&lt;/video&gt;</div><div>&nbsp; &nbsp; &lt;div id="streamCode"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;div id="errorMessage"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="startStream()"&gt;Start Stream&lt;/button&gt;</div><div>&nbsp; &nbsp; &lt;div id="debugInfo"&gt;&lt;/div&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let streamCode;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = 'signaling.php'; // Update this to match your setup</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; function debug(message) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(message);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const debugDiv = document.getElementById('debugInfo');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debugDiv.textContent += message + '\n';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function startStream() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Starting stream...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Clear previous error messages</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = '';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('debugInfo').textContent = '';</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Get media stream</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('localVideo').srcObject = localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Got media stream');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Create peer connection</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; peerConnection.addTrack(track, localStream));</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Added tracks to peer connection');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Create offer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = await peerConnection.createOffer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(offer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Created and set local description');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Wait for ICE gathering</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Waiting for ICE gathering...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await new Promise(resolve =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.addEventListener('icegatheringstatechange', () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`ICE gathering state: ${peerConnection.iceGatheringState}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Sending offer to server...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const requestBody = {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action: 'create',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; offer: JSON.stringify(peerConnection.localDescription)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`Request body: ${JSON.stringify(requestBody, null, 2)}`);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(API_URL, {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method: 'POST',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers: {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Content-Type': 'application/json',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body: JSON.stringify(requestBody)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!response.ok) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const errorText = await response.text();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error(`Server error (${response.status}): ${errorText}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`Server response: ${JSON.stringify(data, null, 2)}`);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!data.code) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error('No stream code received from server');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; streamCode = data.code</div><div><br></div><div><br></div><div>continue</div><div><br></div><div><br></div><div><br></div><div>Here's the complete updated host.html:</div><div><br></div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream&lt;/title&gt;</div><div>&nbsp; &nbsp; &lt;style&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #streamCode {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 24px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 20px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f0f0f0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #errorMessage {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: red;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; #debugInfo {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-family: monospace;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; white-space: pre-wrap;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f8f8f8;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-top: 20px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max-height: 200px;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; overflow-y: auto;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; video {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max-width: 100%;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 10px 0;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/style&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Host Video Stream&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;video id="localVideo" autoplay muted&gt;&lt;/video&gt;</div><div>&nbsp; &nbsp; &lt;div id="streamCode"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;div id="errorMessage"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="startStream()"&gt;Start Stream&lt;/button&gt;</div><div>&nbsp; &nbsp; &lt;div id="debugInfo"&gt;&lt;/div&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let peerConnection;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; let streamCode;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const servers = { iceServers: [{ urls: 'stun:stun.l.google.com:19302' }] };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = 'signaling.php'; // Make sure this matches your setup</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; function debug(message) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const timestamp = new Date().toLocaleTimeString();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const formattedMessage = `[${timestamp}] ${message}`;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log(formattedMessage);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const debugDiv = document.getElementById('debugInfo');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debugDiv.textContent = formattedMessage + '\n' + debugDiv.textContent;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; function showError(message) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = message;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`ERROR: ${message}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function startStream() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Starting stream...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Clear previous states</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('errorMessage').textContent = '';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('streamCode').textContent = '';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.close();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (localStream) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; track.stop());</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Get media stream</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('localVideo').srcObject = localStream;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Got media stream');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Create peer connection</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection = new RTCPeerConnection(servers);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStream.getTracks().forEach(track =&gt; peerConnection.addTrack(track, localStream));</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Added tracks to peer connection');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Create offer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const offer = await peerConnection.createOffer();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setLocalDescription(offer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Created and set local description');</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Wait for ICE gathering</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Waiting for ICE gathering...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await new Promise((resolve) =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const checkState = () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (peerConnection.iceGatheringState === 'complete') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; checkState();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; peerConnection.addEventListener('icegatheringstatechange', checkState);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Timeout after 5 seconds</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setTimeout(() =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; resolve();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('ICE gathering timed out, proceeding anyway');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }, 5000);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Sending offer to server...');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(API_URL, {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; method: 'POST',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; headers: {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Content-Type': 'application/json',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; },</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body</div><div><br></div><div><br></div><div>continue from here, dont give complete file again</div><div><br></div><div><br></div><div><br></div><div>Continuing from the last part of the script:</div><div><br></div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; body: JSON.stringify({</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; action: 'create',</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; offer: JSON.stringify(peerConnection.localDescription)</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; })</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!response.ok) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const errorText = await response.text();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error(`Server error (${response.status}): ${errorText}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`Server response: ${JSON.stringify(data)}`);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!data.code) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error('No stream code received from server');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; streamCode = data.code;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('streamCode').textContent = `Stream Code: ${streamCode}`;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`Stream code generated: ${streamCode}`);</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Start polling for answer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pollForAnswer();</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; showError(`Failed to start stream: ${error.message}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('Detailed error:', error);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function pollForAnswer() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const checkAnswer = async () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(`${API_URL}?code=${streamCode}&amp;type=answer`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!response.ok) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Error(`Server error: ${response.status}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (data.answer) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Received answer from viewer');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const answer = JSON.parse(data.answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; await peerConnection.setRemoteDescription(answer);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug('Successfully set remote description');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; debug(`Error polling for answer: ${error.message}`);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const poll = async () =&gt; {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!await checkAnswer()) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setTimeout(poll, 1000);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; };</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; poll();</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/script&gt;</div><div>&lt;/body&gt;</div><div>&lt;/html&gt;</div><div>Also, let's verify the signaling.php file is working by adding some debug logging at the start:</div><div><br></div><div><br></div><div>&lt;?php</div><div>// Add this at the start of signaling.php</div><div>error_reporting(E_ALL);</div><div>ini_set('display_errors', 1);</div><div><br></div><div>// Create a log file</div><div>file_put_contents('debug.log', date('[Y-m-d H:i:s] ') . "Request received\n", FILE_APPEND);</div><div>file_put_contents('debug.log', date('[Y-m-d H:i:s] ') . "Method: " . $_SERVER['REQUEST_METHOD'] . "\n", FILE_APPEND);</div><div><br></div><div>// Rest of the signaling.php code...</div><div>To test if the connection to the PHP file is working:</div><div><br></div><div>Create a simple test.php file in the same directory:</div><div><br></div><div>&lt;?php</div><div>echo json_encode(['status' =&gt; 'working']);</div><div>?&gt;</div><div>Then in your browser console, test the connection:</div><div><br></div><div>fetch('test.php')</div><div>&nbsp; &nbsp; .then(response =&gt; response.json())</div><div>&nbsp; &nbsp; .then(data =&gt; console.log(data))</div><div>&nbsp; &nbsp; .catch(error =&gt; console.error('Error:', error));</div><div>This will help identify if there's a problem with:</div><div><br></div><div>The PHP server setup</div><div>The file permissions</div><div>The API_URL path</div><div>The server configuration</div><div>Make sure:</div><div><br></div><div>The API_URL in your HTML file points to the correct location of signaling.php</div><div>PHP has write permissions in the directory</div><div>The web server is configured to execute PHP files</div><div>Cross-origin requests are allowed if you're testing from a different domain</div><div><br></div><div><br></div><div>Mixed Content: The page at 'https://www.w3schools.com/html/tryit.asp?filename=tryhtml_basic' was loaded over HTTPS, but requested an insecure resource 'http://piggy.rf.gd/jarvis/cctv/signaling-php/test.php'. This request has been blocked; the content must be served over HTTPS.</div><div><br></div><div><br></div><div><br></div><div>Ah, I see the issue. You're trying to access an HTTP endpoint from an HTTPS page, which browsers block for security reasons. You have two options:</div><div><br></div><div>Enable HTTPS on your server (recommended):</div><div>If you're using a free hosting service like 000webhost or InfinityFree, they usually provide free SSL certificates. Check your hosting control panel to enable HTTPS.</div><div>For testing purposes only, you can use a CORS proxy. Update your API_URL to use HTTPS:</div><div><br></div><div>// In host.html and viewer.html, modify the API_URL:</div><div>const API_URL = 'https://cors-anywhere.herokuapp.com/http://piggy.rf.gd/jarvis/cctv/signaling-php/signaling.php';</div><div>However, the better solution is to enable HTTPS on your server. Here's how you can do it:</div><div><br></div><div>If you're using InfinityFree or similar hosting:</div><div>Go to your hosting control panel</div><div>Look for "SSL/TLS" or "SSL Certificate"</div><div>Enable the free SSL certificate</div><div>Wait for it to be issued (usually takes a few minutes)</div><div>Then update your API_URL to use HTTPS:</div><div><br></div><div>const API_URL = 'https://piggy.rf.gd/jarvis/cctv/signaling-php/signaling.php';</div><div>Also update your signaling.php to force HTTPS:</div><div><br></div><div>&lt;?php</div><div>// Add this at the start of your signaling.php</div><div>if (!isset($_SERVER['HTTPS']) || $_SERVER['HTTPS'] !== 'on') {</div><div>&nbsp; &nbsp; // If we're not using HTTPS, redirect to HTTPS</div><div>&nbsp; &nbsp; $redirectURL = 'https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];</div><div>&nbsp; &nbsp; header("Location: $redirectURL");</div><div>&nbsp; &nbsp; exit();</div><div>}</div><div><br></div><div>// Rest of your signaling.php code...</div><div>If you're using InfinityFree specifically:</div><div><br></div><div>Go to your control panel</div><div>Click on "SSL/TLS"</div><div>Click "Install Certificate"</div><div>Select your domain</div><div>Wait for the certificate to be issued</div><div>Once active, your site will be accessible via HTTPS</div><div>After enabling HTTPS, make sure to:</div><div><br></div><div>Update all your URLs to use https:// instead of http://</div><div>Test the connection using the browser console:</div><div><br></div><div>fetch('https://piggy.rf.gd/jarvis/cctv/signaling-php/test.php')</div><div>&nbsp; &nbsp; .then(response =&gt; response.json())</div><div>&nbsp; &nbsp; .then(data =&gt; console.log(data))</div><div>&nbsp; &nbsp; .catch(error =&gt; console.error('Error:', error));</div><div>This should resolve the Mixed Content error and allow your WebRTC application to work properly.</div><div><br></div><div><br></div><div><br></div><div>Failed to start stream: Unexpected token '&lt;', "&lt;bod"... is not valid JSON</div><div><br></div><div><br></div><div><br></div><div>This error indicates that the PHP server is returning an HTML error page instead of JSON. Let's debug this:</div><div><br></div><div>First, modify your signaling.php to ensure it's returning proper JSON:</div><div><br></div><div>&lt;?php</div><div>// Disable error display in HTML format</div><div>ini_set('display_errors', 0);</div><div>error_reporting(E_ALL);</div><div><br></div><div>// Set proper JSON headers</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>// Log errors to a file instead of displaying them</div><div>ini_set('log_errors', 1);</div><div>ini_set('error_log', 'debug.log');</div><div><br></div><div>try {</div><div>&nbsp; &nbsp; // Directory to store stream data</div><div>&nbsp; &nbsp; $streamDir = 'streams/';</div><div>&nbsp; &nbsp; if (!file_exists($streamDir)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (!mkdir($streamDir, 0777, true)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Failed to create streams directory");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; if ($_SERVER['REQUEST_METHOD'] === 'POST') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $input = file_get_contents('php://input');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $data = json_decode($input, true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (json_last_error() !== JSON_ERROR_NONE) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Invalid JSON input");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; $action = $data['action'] ?? '';</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; if ($action === 'create') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Generate code and save offer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; do {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code = str_pad(rand(0, 999999), 6, '0', STR_PAD_LEFT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } while (file_exists($streamDir . $code . '.json'));</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $streamData = [</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'offer' =&gt; $data['offer'],</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'timestamp' =&gt; time(),</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'answer' =&gt; null</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!file_put_contents($streamDir . $code . '.json', json_encode($streamData))) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Failed to save stream data");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['code' =&gt; $code]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; elseif ($action === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Handle answer</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $code = $data['code'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $filePath = $streamDir . $code . '.json';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!file_exists($filePath)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Stream not found");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $streamData = json_decode(file_get_contents($filePath), true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $streamData['answer'] = $data['answer'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!file_put_contents($filePath, json_encode($streamData))) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Failed to save answer");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['status' =&gt; 'success']);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Invalid action");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; elseif ($_SERVER['REQUEST_METHOD'] === 'GET') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $code = $_GET['code'] ?? '';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $type = $_GET['type'] ?? '';</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $filePath = $streamDir . $code . '.json';</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (!file_exists($filePath)) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Stream not found");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; $streamData = json_decode(file_get_contents($filePath), true);</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if ($type === 'offer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['offer' =&gt; $streamData['offer']]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; elseif ($type === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo json_encode(['answer' =&gt; $streamData['answer']]);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw new Exception("Invalid type");</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>} catch (Exception $e) {</div><div>&nbsp; &nbsp; http_response_code(400);</div><div>&nbsp; &nbsp; echo json_encode(['error' =&gt; $e-&gt;getMessage()]);</div><div>&nbsp; &nbsp; error_log("Error: " . $e-&gt;getMessage());</div><div>}</div><div>?&gt;</div><div>Create a test.php to verify the server is working:</div><div><br></div><div>&lt;?php</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>echo json_encode(['status' =&gt; 'working']);</div><div>?&gt;</div><div>Modify your host.html fetch call to include error handling:</div><div><br></div><div>debug('Sending offer to server...');</div><div><br></div><div><br></div><div>its still giving the same error even after changing</div><div><br></div><div><br></div><div><br></div><div>Let's try to debug this step by step:</div><div><br></div><div>First, create a simple test.php to check if your server is properly configured:</div><div><br></div><div>&lt;?php</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>echo json_encode([</div><div>&nbsp; &nbsp; 'status' =&gt; 'working',</div><div>&nbsp; &nbsp; 'time' =&gt; date('Y-m-d H:i:s')</div><div>]);</div><div>?&gt;</div><div>Then modify your host.html to first test the connection:</div><div><br></div><div>&lt;!DOCTYPE html&gt;</div><div>&lt;html lang="en"&gt;</div><div>&lt;head&gt;</div><div>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;</div><div>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</div><div>&nbsp; &nbsp; &lt;title&gt;Host Video Stream - Test&lt;/title&gt;</div><div>&lt;/head&gt;</div><div>&lt;body&gt;</div><div>&nbsp; &nbsp; &lt;h1&gt;Connection Test&lt;/h1&gt;</div><div>&nbsp; &nbsp; &lt;div id="result"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &lt;button onclick="testConnection()"&gt;Test Connection&lt;/button&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;script&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; const API_URL = 'https://piggy.rf.gd/jarvis/cctv/signaling-php/test.php';</div><div><br></div><div>&nbsp; &nbsp; &nbsp; &nbsp; async function testConnection() {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(API_URL);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const text = await response.text(); // Get raw text first</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Raw response:', text);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = JSON.parse(text);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.log('Parsed JSON:', data);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('result').textContent =&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Connection successful: ' + JSON.stringify(data);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (jsonError) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('JSON parsing error:', jsonError);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('result').textContent =&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Received non-JSON response: ' + text;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('Fetch error:', error);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; document.getElementById('result').textContent =&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'Connection failed: ' + error.message;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; &lt;/script&gt;</div><div>&lt;/body&gt;</div><div>&lt;/html&gt;</div><div>If you're still getting HTML instead of JSON, it might be because:</div><div>Your PHP file isn't being processed as PHP</div><div>There's a server configuration issue</div><div>There's an error in your PHP code that's causing the server to return an error page</div><div>Try this modified signaling.php:</div><div><br></div><div><br></div><div>&lt;?php</div><div>// First line should be blank - no spaces or anything before &lt;?php</div><div><br></div><div>// For debugging</div><div>error_reporting(E_ALL);</div><div>ini_set('display_errors', 0);</div><div>ini_set('log_errors', 1);</div><div>ini_set('error_log', 'error.log');</div><div><br></div><div>// Set headers</div><div>header('Content-Type: application/json');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>// Log request details</div><div>error_log("Request received: " . $_SERVER['REQUEST_METHOD']);</div><div>error_log("Raw input: " . file_get_contents('php://input'));</div><div><br></div><div>// Simple test response</div><div>echo json_encode([</div><div>&nbsp; &nbsp; 'status' =&gt; 'ok',</div><div>&nbsp; &nbsp; 'method' =&gt; $_SERVER['REQUEST_METHOD'],</div><div>&nbsp; &nbsp; 'time' =&gt; date('Y-m-d H:i:s')</div><div>]);</div><div>?&gt;</div><div>Also check your server's file extension associations:</div><div>Make sure the file has a .php extension</div><div>Make sure your web server is configured to process .php files with PHP</div><div>Check if PHP is installed and running on your server</div><div>You can also try accessing the PHP file directly in your browser:</div><div>https://piggy.rf.gd/jarvis/cctv/signaling-php/test.php</div><div>If you see HTML output instead of JSON, it means your PHP isn't being processed correctly. In that case:</div><div><br></div><div>Check if your hosting provider supports PHP</div><div>Make sure the file extension is .php</div><div>Try adding a .htaccess file in your directory:</div><div><br></div><div>AddType application/x-httpd-php .php</div><div>Let me know what you see when you:</div><div><br></div><div>Access test.php directly in your</div><div><br></div><div><br></div><div>cant you modify signaling file to display plain text instead of any html or json etc. just fix this, and now it is able to fetch and</div><div><br></div><div><br></div><div><br></div><div>Yes, let's modify the signaling.php to output plain text first to debug:</div><div><br></div><div><br></div><div>&lt;?php</div><div>// Disable any HTML output</div><div>error_reporting(0);</div><div>ini_set('display_errors', 0);</div><div><br></div><div>// Just output plain text</div><div>header('Content-Type: text/plain');</div><div>header('Access-Control-Allow-Origin: *');</div><div>header('Access-Control-Allow-Methods: GET, POST');</div><div>header('Access-Control-Allow-Headers: Content-Type');</div><div><br></div><div>// Create streams directory if it doesn't exist</div><div>$streamDir = 'streams/';</div><div>if (!file_exists($streamDir)) {</div><div>&nbsp; &nbsp; mkdir($streamDir, 0777, true);</div><div>}</div><div><br></div><div>if ($_SERVER['REQUEST_METHOD'] === 'POST') {</div><div>&nbsp; &nbsp; $input = file_get_contents('php://input');</div><div>&nbsp; &nbsp; $data = json_decode($input, true);</div><div>&nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; if ($data['action'] === 'create') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Generate code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $code = str_pad(rand(0, 999999), 6, '0', STR_PAD_LEFT);</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Save data</div><div>&nbsp; &nbsp; &nbsp; &nbsp; file_put_contents($streamDir . $code . '.txt', $data['offer']);</div><div>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; // Return just the code</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo $code;</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; else if ($data['action'] === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; $code = $data['code'];</div><div>&nbsp; &nbsp; &nbsp; &nbsp; file_put_contents($streamDir . $code . '_answer.txt', $data['answer']);</div><div>&nbsp; &nbsp; &nbsp; &nbsp; echo "OK";</div><div>&nbsp; &nbsp; }</div><div>}</div><div>else if ($_SERVER['REQUEST_METHOD'] === 'GET') {</div><div>&nbsp; &nbsp; $code = $_GET['code'];</div><div>&nbsp; &nbsp; $type = $_GET['type'];</div><div>&nbsp; &nbsp;&nbsp;</div><div>&nbsp; &nbsp; if ($type === 'offer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists($streamDir . $code . '.txt')) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo file_get_contents($streamDir . $code . '.txt');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "NOT_FOUND";</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>&nbsp; &nbsp; else if ($type === 'answer') {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; if (file_exists($streamDir . $code . '_answer.txt')) {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo file_get_contents($streamDir . $code . '_answer.txt');</div><div>&nbsp; &nbsp; &nbsp; &nbsp; } else {</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "NO_ANSWER";</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }</div><div>&nbsp; &nbsp; }</div><div>}</div><div>?&gt;</div><div>This version:</div><div><br></div><div>Uses plain text responses instead of JSON</div><div>Stores data in simple text files</div><div>Uses minimal error handling</div><div>Has simple responses like "OK", "NOT_FOUND", etc.</div><div>You'll need to modify your JavaScript code to handle these plain text responses. Let me know if you want me to provide the modified JavaScript code as well.</div><p>Saved at: 2024-11-07 01:22:32</p>