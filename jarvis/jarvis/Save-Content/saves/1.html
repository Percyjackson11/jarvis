<div class="st-emotion-cache-1629p8f e1nzilvr2" style="font-size: 16px; box-sizing: border-box; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><h3 level="3" id="overview" style="box-sizing: border-box; font-size: 1.75rem; letter-spacing: -0.005em; padding: 0.5rem 0px 1rem; margin: 0px; line-height: 1.2; scroll-margin-top: 2rem;"><div data-testid="StyledLinkIconContainer" class="st-emotion-cache-zt5igj e1nzilvr4" style="box-sizing: border-box; position: relative; left: calc(-3rem); width: calc(100% + 2.5rem + 0.5rem); display: flex; -webkit-box-align: center; align-items: center; overflow: visible;"><span class="st-emotion-cache-10trblm e1nzilvr1" style="box-sizing: border-box; position: relative; flex: 1 1 0%; margin-left: calc(3rem); scroll-margin-top: 2rem;">Overview</span></div></h3></div><p style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; word-break: break-word; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);">This PHP script is part of a library designed to improve the readability of HTML content by extracting the main article content, title, author, main image, and other metadata, removing clutter such as ads, navigation bars, and footers. It's structured as a class named&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">Readability</code>&nbsp;within the namespace&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">andreskrey\Readability</code>.</p><div class="st-emotion-cache-1629p8f e1nzilvr2" style="font-size: 16px; box-sizing: border-box; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><h3 level="3" id="namespace-and-class-imports" style="box-sizing: border-box; font-size: 1.75rem; letter-spacing: -0.005em; padding: 0.5rem 0px 1rem; margin: 0px; line-height: 1.2; scroll-margin-top: 2rem;"><div data-testid="StyledLinkIconContainer" class="st-emotion-cache-zt5igj e1nzilvr4" style="box-sizing: border-box; position: relative; left: calc(-3rem); width: calc(100% + 2.5rem + 0.5rem); display: flex; -webkit-box-align: center; align-items: center; overflow: visible;"><a href="https://doubt-ai.streamlit.app/~/+/#namespace-and-class-imports" class="st-emotion-cache-eczf16 e1nzilvr3" style="box-sizing: border-box; color: rgb(0, 104, 201); position: absolute; margin-right: 0.5rem; line-height: 0; display: inline-flex; -webkit-box-align: center; align-items: center; -webkit-box-pack: center; justify-content: center; transform: scale(0); transition: opacity 300ms ease 150ms, transform 300ms ease 150ms; opacity: 0; height: 2.5rem; width: 2.5rem; z-index: 101; border: none; border-radius: 50%;"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><span class="st-emotion-cache-10trblm e1nzilvr1" style="box-sizing: border-box; position: relative; flex: 1 1 0%; margin-left: calc(3rem); scroll-margin-top: 2rem;">Namespace and Class Imports</span></div></h3></div><ul style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;">The script declares its namespace and imports necessary classes for DOM manipulation and utility functions, indicating it's part of a structured library designed for readability improvements.</li></ul><div class="st-emotion-cache-1629p8f e1nzilvr2" style="font-size: 16px; box-sizing: border-box; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><h3 level="3" id="class-readability" style="box-sizing: border-box; font-size: 1.75rem; letter-spacing: -0.005em; padding: 0.5rem 0px 1rem; margin: 0px; line-height: 1.2; scroll-margin-top: 2rem;"><div data-testid="StyledLinkIconContainer" class="st-emotion-cache-zt5igj e1nzilvr4" style="box-sizing: border-box; position: relative; left: calc(-3rem); width: calc(100% + 2.5rem + 0.5rem); display: flex; -webkit-box-align: center; align-items: center; overflow: visible;"><a href="https://doubt-ai.streamlit.app/~/+/#class-readability" class="st-emotion-cache-eczf16 e1nzilvr3" style="box-sizing: border-box; color: rgb(0, 104, 201); position: absolute; margin-right: 0.5rem; line-height: 0; display: inline-flex; -webkit-box-align: center; align-items: center; -webkit-box-pack: center; justify-content: center; transform: scale(0); transition: opacity 300ms ease 150ms, transform 300ms ease 150ms; opacity: 0; height: 2.5rem; width: 2.5rem; z-index: 101; border: none; border-radius: 50%;"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><span class="st-emotion-cache-10trblm e1nzilvr1" style="box-sizing: border-box; position: relative; flex: 1 1 0%; margin-left: calc(3rem); scroll-margin-top: 2rem;">Class&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">Readability</code></span></div></h3></div><ul style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Properties</span>: The class defines several protected properties to store the DOM document, extracted metadata (title, author, image, etc.), configuration settings, a logger for logging activities, and arrays for scoring and processing HTML elements.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Constructor</span>: Accepts a&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">Configuration</code>&nbsp;object and initializes the class properties, particularly the logger.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Main Method&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">parse($html)</code></span>: This method orchestrates the parsing process. It loads the HTML content into a DOM document, extracts metadata, identifies and scores relevant content nodes, and cleans the content for readability.<ul style="box-sizing: border-box; margin: 0px; padding: 0px; font-size: 1rem;"><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Loading HTML</span>: Utilizes&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">loadHTML($html)</code>&nbsp;to load the provided HTML string into a&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">DOMDocument</code>&nbsp;object, handling character encoding and removing scripts for security.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Metadata Extraction</span>:&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">getMetadata()</code>&nbsp;method extracts metadata like title, author, and main image from the HTML's meta tags.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Content Scoring and Selection</span>: Nodes within the HTML document are scored based on their likelihood of containing meaningful content. This involves analyzing elements like paragraphs, headings, and sections. The&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">getNodes($node)</code>&nbsp;method retrieves potential content nodes, while&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">rateNodes($elementsToScore)</code>&nbsp;assigns scores based on content length, punctuation, and structure.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Content Cleaning</span>: The&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">prepArticle(DOMDocument $article)</code>&nbsp;method cleans the selected content, removing unnecessary elements and styling to enhance readability.</li></ul></li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Utility Methods</span>: The class includes several methods for specific tasks like cleaning styles (<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">_cleanStyles($node)</code>), removing matched nodes (<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">_cleanMatchedNodes($node, $regex)</code>), and converting relative URLs to absolute (<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">toAbsoluteURI($uri)</code>).</li></ul><div class="st-emotion-cache-1629p8f e1nzilvr2" style="font-size: 16px; box-sizing: border-box; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><h3 level="3" id="parsing-algorithm" style="box-sizing: border-box; font-size: 1.75rem; letter-spacing: -0.005em; padding: 0.5rem 0px 1rem; margin: 0px; line-height: 1.2; scroll-margin-top: 2rem;"><div data-testid="StyledLinkIconContainer" class="st-emotion-cache-zt5igj e1nzilvr4" style="box-sizing: border-box; position: relative; left: calc(-3rem); width: calc(100% + 2.5rem + 0.5rem); display: flex; -webkit-box-align: center; align-items: center; overflow: visible;"><a href="https://doubt-ai.streamlit.app/~/+/#parsing-algorithm" class="st-emotion-cache-eczf16 e1nzilvr3" style="box-sizing: border-box; color: rgb(0, 104, 201); position: absolute; margin-right: 0.5rem; line-height: 0; display: inline-flex; -webkit-box-align: center; align-items: center; -webkit-box-pack: center; justify-content: center; transform: scale(0); transition: opacity 300ms ease 150ms, transform 300ms ease 150ms; opacity: 0; height: 2.5rem; width: 2.5rem; z-index: 101; border: none; border-radius: 50%;"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><span class="st-emotion-cache-10trblm e1nzilvr1" style="box-sizing: border-box; position: relative; flex: 1 1 0%; margin-left: calc(3rem); scroll-margin-top: 2rem;">Parsing Algorithm</span></div></h3></div><ol style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Initialization</span>: The parsing process begins with loading the HTML content into a DOM document, preparing it by removing scripts and normalizing entities.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Metadata Extraction</span>: The script extracts metadata from the HTML, using both explicit meta tags and heuristics to identify the title, author, main image, etc.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Content Identification and Scoring</span>: The algorithm identifies potential content-bearing nodes (e.g., paragraphs, sections) and scores them based on criteria designed to estimate their relevance to the main article content. This involves analyzing the structure and content of the HTML document to identify the most meaningful parts.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Content Selection and Cleaning</span>: Based on scores, the most relevant content is selected. This content is then cleaned to remove ads, navigation, and other non-essential elements, aiming to leave only the main article content.</li><li style="box-sizing: border-box; margin: 0.2em 0px 0.2em 1.2em; padding: 0px 0px 0px 0.6em; font-size: 1rem;"><span style="box-sizing: border-box; font-weight: 600;">Output Preparation</span>: The cleaned content, along with extracted metadata, is prepared for output. This may involve further cleaning of styles and classes to ensure the content is presented in a readable format.</li></ol><div class="st-emotion-cache-1629p8f e1nzilvr2" style="font-size: 16px; box-sizing: border-box; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);"><h3 level="3" id="conclusion" style="box-sizing: border-box; font-size: 1.75rem; letter-spacing: -0.005em; padding: 0.5rem 0px 1rem; margin: 0px; line-height: 1.2; scroll-margin-top: 2rem;"><div data-testid="StyledLinkIconContainer" class="st-emotion-cache-zt5igj e1nzilvr4" style="box-sizing: border-box; position: relative; left: calc(-3rem); width: calc(100% + 2.5rem + 0.5rem); display: flex; -webkit-box-align: center; align-items: center; overflow: visible;"><a href="https://doubt-ai.streamlit.app/~/+/#conclusion" class="st-emotion-cache-eczf16 e1nzilvr3" style="box-sizing: border-box; color: rgb(0, 104, 201); position: absolute; margin-right: 0.5rem; line-height: 0; display: inline-flex; -webkit-box-align: center; align-items: center; -webkit-box-pack: center; justify-content: center; transform: scale(0); transition: opacity 300ms ease 150ms, transform 300ms ease 150ms; opacity: 0; height: 2.5rem; width: 2.5rem; z-index: 101; border: none; border-radius: 50%;"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><span class="st-emotion-cache-10trblm e1nzilvr1" style="box-sizing: border-box; position: relative; flex: 1 1 0%; margin-left: calc(3rem); scroll-margin-top: 2rem;">Conclusion</span></div></h3></div><p style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; word-break: break-word; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);">The&nbsp;<code style="box-sizing: border-box; font-size: 0.75em; padding: 0.2em 0.4em; margin: 0px; border-radius: 0.25rem; background: rgb(248, 249, 251); color: rgb(9, 171, 59); font-family: &quot;Source Code Pro&quot;, monospace; overflow-wrap: break-word;">Readability</code>&nbsp;class represents a sophisticated effort to distill essential content from web pages, making it more accessible and readable. The actual implementation involves detailed parsing and scoring of HTML elements, DOM manipulation, and careful consideration of web content structure and semantics.</p><p style="font-size: 16px; box-sizing: border-box; margin: 0px 0px 1rem; padding: 0px; word-break: break-word; color: rgb(49, 51, 63); font-family: &quot;Source Sans Pro&quot;, sans-serif; background-color: rgb(255, 255, 255);">Recreating this script "one to one" would require not only a deep understanding of the PHP language and DOM manipulation but also insights into how web content is structured and how to differentiate between meaningful content and clutter programmatically.</p><p>Saved at: 2024-04-22 10:41:12</p>